read -p "Classpath (default: ../../build/gin.jar): " classpath
read -p "Project (default: spatial4j): " project
read -p "ProfilerOutput (default: $project.Profiler_output.csv): " profileroutput
read -p "mavenHome (default: /usr/share/maven): " mavenhome
read -p "editType (default: LINE): " edittype
read -p "Generations (default: 10): " generations
read -p "Individuals (default: 20): " individuals
read -p "Elites (default: 2): " elites
read -p "Overall method number: " overallmethods
read -p "patchNumber (defalt: 500): " patchnumber
read -p "homsize (default: 2): " homsize
read -p "Experiment Iterations (default: 10): " iterations
read -p "output file name: " outputfile

: ${classpath:=../../build/gin.jar}
: ${project:=spatial4j}
: ${profileroutput:=$project.Profiler_output.csv}
: ${mavenhome:=/usr/share/maven}
: ${edittype:=LINE}
: ${generations:=1}#10
: ${individuals:=10}#20
: ${elites:=2}#2
: ${overallmethods:=14}#2
: ${patchnumber:=5}#500
: ${homsize:=2}#2
: ${iterations:=5}#10
: ${outputfile:="RESULTS_TOP_"$project".GPHOM_gn"$generations"_in"$individuals"_e"$elites"_pn"$patchnumber"_top"$top"_homsize"$homsize"_output.csv"}

toprow=\"iteration\"
j=5
for ((overallcount=0;j<=$overallmethods;j+=5,overallcount++))
do
    toprow=${toprow},\"$j\"
done
let j=$j-5
if [ $overallmethods -gt $j ]
then
    let overallcount=$overallcount+1
    toprow=${toprow},\"$overallmethods\"
fi
echo $toprow >> $outputfile



for ((i=0;i<$iterations;i++))
do
    row=\"$i\"
    declare -a outputarray

    for ((topcount=1;$topcount<=$overallcount;topcount++))
    do
        if [ $topcount = $overallcount ]
        then
            methods=$overallmethods 
        else
             let methods=$topcount\*5  
        fi

        outputName=$project".GPHOM_TOPExperiment_gn"$generations"_in"$individuals"_e"$elites"_pn"$patchnumber"_top"$top"_homsize"$homsize".iteration"$i"_output.csv"
        tmpf="$(mktemp)"
        /usr/bin/time -f %U -o "$tmpf" java -Dtinylog.level=trace -cp $classpath gin.util.GPRuntime -j -p $project -d . -m $profileroutput -o $outputname -mavenHome $mavenhome -et $edittype -gn $generations -in $individuals -e $elites -hom true -t $methods -pn $patchnumber -homsize $homsize
        usertime="$(cat "$tmpf")"
        rm "$tmpf"
        row=${row},\"$usertime\"      
        #outputarray=(${outputarray[@]} $usertime)
    done
    echo $row >> $outputfile
done


